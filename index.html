
<html>
	<head>
		<meta charset="utf-8" />
		<title> Labyrint</title>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script src="visualizer.js" type="text/javascript"></script>
	</head>

	
	
	<body>
		
			<header>
				<link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
				<h1 id="title">Labyrint</h1>
			</header>

			<div class="wrapper">
				<canvas class="visualizer"></canvas>
			</div>

			

			<script>

				window.navigator = window.navigator || {};

	     		navigator.getUserMedia = navigator.getUserMedia       ||
	                               navigator.webkitGetUserMedia ||
	                               navigator.mozGetUserMedia    ||
	                               null;


	            //Initierar ljudkontexten tillsammans med egenskaperna för analysen
				var context = new (window.AudioContext || window.webkitAudioContext)();
				var analyser = context.createAnalyser();
				analyser.fftSize = 2048;
				var bufferLength = analyser.frequencyBinCount; // half the FFT value
   				var dataArray = new Uint8Array(bufferLength); // create an array to store the data
				
				//Tar in mikrofonljud, samt ritar om intagandet går bra.
				navigator.getUserMedia({audio: true}, function(stream) {
					
					var source = context.createMediaStreamSource(stream);
					source.connect(analyser);

					draw();

				}, errorCallback);

				//Om det inte går att få mikrofonljudet
				function errorCallback() {
	    			
	    			alert('something went wrong');
				}


				//Initerar canvas-egenskaper
				var canvas = document.querySelector('.visualizer');
				var canvasCtx = canvas.getContext("2d");
				var intendedWidth = document.querySelector('.wrapper').clientWidth;
				canvas.setAttribute('width',intendedWidth);
				WIDTH = canvas.width;
				HEIGHT = canvas.height;
				canvasCtx.clearRect(0, 0, WIDTH, HEIGHT);

				function draw() {

					requestAnimationFrame(draw);

					analyser.getByteFrequencyData(dataArray);

					setUpVisualizer();
					

				}

			

			</script>

	</body>
</html>