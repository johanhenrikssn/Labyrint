
<html>
	<head>
		<meta charset="utf-8" />
		<title> Labyrint</title>
		<link rel="stylesheet" type="text/css" href="style.css">
		<script src="js/two.min.js"></script>
	</head>
	<body>
		
			<header>
				<link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>

		
			</header>			

			<script>

				window.navigator = window.navigator || {};

	     		navigator.getUserMedia = navigator.getUserMedia       ||
	                               navigator.webkitGetUserMedia ||
	                               navigator.mozGetUserMedia    ||
	                               null;


				var context = new (window.AudioContext || window.webkitAudioContext)();
				
				var analyser = context.createAnalyser();
				var bufferLength = analyser.frequencyBinCount; // half the FFT value
   				var dataArray = new Uint8Array(bufferLength); // create an array to store the data
				
				navigator.getUserMedia({audio: true}, function(stream) {
					
					var source = context.createMediaStreamSource(stream);
					source.connect(analyser);

					update();

				}, errorCallback);


				//..........All Graphics.......................
				// Make an instance of two and place it on the page
				var params = { width: 1000, height: 200 };
				var two = new Two(params).appendTo(document.body);

				var circle = two.makeCircle(72, 100, 50);

				circle.fill = 'lightblue';
				circle.stroke = 'blue';
				circle.linewidth = 1;
				var xstartPosition = 500;
				var ystartPosition = 50;
				circle.translation.set(xstartPosition,ystartPosition);

				var delta = new Two.Vector(0, 0);
				
				var temp = 0;
				var temp2 = 0;

			
				// animationloop
				two.bind('update', function(frameCount) {

				//DEN STARKASTE FREKVENSEN SKA IN DÄR DDET STÅR DATAARRAY[32]
				temp2 = dataArray[32]/2; 
				
				if(temp == temp2)
					delta.x = 0;
				else if(temp < temp2)
					delta.x = -1;
				else if(temp > temp2)
					delta.x = 1;

				temp = dataArray[32]/2; 
			
				circle.translation.addSelf(delta);

				}).play();


				// render everything to the screen
				two.update();
				//..............................................


				function errorCallback() {
	    			
	    			alert('something went wrong');
				}


				function update() {

					// Schedule the next update
					requestAnimationFrame(update);

					analyser.getByteFrequencyData(dataArray);
				
					
				};

			</script>

	</body>
</html>